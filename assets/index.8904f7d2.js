import{K as S,r as Q,a1 as H,k as I,a0 as O,ak as i,au as k,o as s,a as W,Y as t,S as a,ac as X,T as _,R as c,W as r,X as Y,u as G}from"./vue.e20a9695.js";import{c as J}from"./commonFunction.eda888b5.js";import{e as C,f as w,z as x,E as z}from"./index.b8a2e51c.js";import{_ as L}from"./editNotice.vue_vue_type_script_setup_true_name_sysNoticeEdit_lang.69feb72b.js";import{S as h}from"./sys-notice-api.a1335857.js";import"./formatTime.29ac8c52.js";import"./monacoEditor.48edecf2.js";import"./index.vue_vue_type_script_setup_true_name_wngEditor_lang.c25b38c3.js";import"./sys-file-api.778e504f.js";const Z={class:"sys-notice-container"},ee=S({name:"sysNotice"}),de=S({...ee,setup(te){const b=Q(),{removeHtml:T}=J(),e=H({loading:!1,noticeData:[],queryParams:{title:void 0,type:void 0},tableParams:{page:1,pageSize:10,total:0},editNoticeTitle:""});I(async()=>{p(),C.on("submitRefresh",()=>{p()})}),O(()=>{C.off("submitRefresh")});const p=async()=>{var y,u;e.loading=!0;let l=Object.assign(e.queryParams,e.tableParams);var n=await w(h).apiSysNoticePagePost(l);e.noticeData=((y=n.data.result)==null?void 0:y.items)??[],e.tableParams.total=(u=n.data.result)==null?void 0:u.total,e.loading=!1},q=()=>{e.queryParams.title=void 0,e.queryParams.type=void 0,p()},D=()=>{var l;e.editNoticeTitle="添加通知公告",(l=b.value)==null||l.openDialog({})},B=l=>{var n;e.editNoticeTitle="编辑通知公告",(n=b.value)==null||n.openDialog(l)},V=l=>{x.confirm(`确定删除通知公告：【${l.title}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await w(h).apiSysNoticeDeletePost({id:l.id}),p(),z.success("删除成功")}).catch(()=>{})},E=l=>{x.confirm(`确定发布通知公告：【${l.title}】，不可撤销?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await w(h).apiSysNoticePublicPost({id:l.id}),p(),z.success("发布成功")}).catch(()=>{})},R=l=>{e.tableParams.pageSize=l,p()},U=l=>{e.tableParams.page=l,p()};return(l,n)=>{const y=i("el-input"),u=i("el-form-item"),v=i("el-option"),$=i("el-select"),m=i("el-button"),K=i("el-button-group"),A=i("el-form"),P=i("el-card"),d=i("el-table-column"),g=i("el-tag"),M=i("el-table"),j=i("el-pagination"),f=k("auth"),F=k("loading");return s(),W("div",Z,[t(P,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:a(()=>[t(A,{model:e.queryParams,ref:"queryForm",inline:!0},{default:a(()=>[t(u,{label:"标题",prop:"title"},{default:a(()=>[t(y,{placeholder:"标题",clearable:"",onKeyup:X(p,["enter"]),modelValue:e.queryParams.title,"onUpdate:modelValue":n[0]||(n[0]=o=>e.queryParams.title=o)},null,8,["onKeyup","modelValue"])]),_:1}),t(u,{label:"类型",prop:"type"},{default:a(()=>[t($,{modelValue:e.queryParams.type,"onUpdate:modelValue":n[1]||(n[1]=o=>e.queryParams.type=o),placeholder:"类型",clearable:"",style:{width:"100%"}},{default:a(()=>[t(v,{label:"通知",value:1}),t(v,{label:"公告",value:2})]),_:1},8,["modelValue"])]),_:1}),t(u,null,{default:a(()=>[t(K,null,{default:a(()=>[_((s(),c(m,{type:"primary",icon:"ele-Search",onClick:p},{default:a(()=>[r(" 查询 ")]),_:1})),[[f,"sysNotice:page"]]),t(m,{icon:"ele-Refresh",onClick:q},{default:a(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1}),t(u,null,{default:a(()=>[_((s(),c(m,{type:"primary",icon:"ele-Plus",onClick:D},{default:a(()=>[r(" 新增 ")]),_:1})),[[f,"sysNotice:add"]])]),_:1})]),_:1},8,["model"])]),_:1}),t(P,{shadow:"hover",style:{"margin-top":"8px"}},{default:a(()=>[_((s(),c(M,{data:e.noticeData,style:{width:"100%"},border:""},{default:a(()=>[t(d,{type:"index",label:"序号",width:"55",align:"center"}),t(d,{prop:"title",label:"标题","show-overflow-tooltip":""}),t(d,{prop:"content",label:"内容","show-overflow-tooltip":""},{default:a(o=>[r(Y(G(T)(o.row.content)),1)]),_:1}),t(d,{prop:"type",label:"类型",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.type===1?(s(),c(g,{key:0},{default:a(()=>[r(" 通知 ")]),_:1})):(s(),c(g,{key:1,type:"warning"},{default:a(()=>[r(" 公告 ")]),_:1}))]),_:1}),t(d,{prop:"createTime",label:"创建时间",align:"center","show-overflow-tooltip":""}),t(d,{prop:"status",label:"状态",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.status===1?(s(),c(g,{key:0,type:"info"},{default:a(()=>[r(" 已发布 ")]),_:1})):(s(),c(g,{key:1,type:"warning"},{default:a(()=>[r(" 未发布 ")]),_:1}))]),_:1}),t(d,{prop:"publicUserName",label:"发布者",align:"center","show-overflow-tooltip":""}),t(d,{prop:"publicTime",label:"发布时间",align:"center","show-overflow-tooltip":""}),t(d,{label:"操作",width:"200",fixed:"right",align:"center","show-overflow-tooltip":""},{default:a(o=>[_((s(),c(m,{icon:"ele-Position",size:"small",text:"",type:"primary",onClick:N=>E(o.row),disabled:o.row.status===1},{default:a(()=>[r(" 发布 ")]),_:2},1032,["onClick","disabled"])),[[f,"sysNotice:public"]]),_((s(),c(m,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:N=>B(o.row),disabled:o.row.status===1},{default:a(()=>[r(" 编辑 ")]),_:2},1032,["onClick","disabled"])),[[f,"sysNotice:update"]]),_((s(),c(m,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:N=>V(o.row),disabled:o.row.status===1},{default:a(()=>[r(" 删除 ")]),_:2},1032,["onClick","disabled"])),[[f,"sysNotice:delete"]])]),_:1})]),_:1},8,["data"])),[[F,e.loading]]),t(j,{currentPage:e.tableParams.page,"onUpdate:currentPage":n[2]||(n[2]=o=>e.tableParams.page=o),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":n[3]||(n[3]=o=>e.tableParams.pageSize=o),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:R,onCurrentChange:U,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1}),t(L,{ref_key:"editNoticeRef",ref:b,title:e.editNoticeTitle},null,8,["title"])])}}});export{de as default};
