import{K as x,r as k,a1 as U,k as z,a0 as Q,ak as l,au as q,o as n,a as F,Y as o,S as t,ac as O,T as p,R as c,W as u}from"./vue.e20a9695.js";import{e as g,g as D,f as G,E as I}from"./index.a169e15e.js";import L from"./orgTree.c9970855.js";import{_ as W}from"./editOrg.vue_vue_type_script_setup_true_name_sysEditOrg_lang.68c94096.js";import{S as T}from"./sys-org-api.85b877c8.js";import"./monacoEditor.48edecf2.js";import"./_plugin-vue_export-helper.c27b6911.js";const Y={class:"sys-org-container"},j=x({name:"sysOrg"}),le=x({...j,setup(H){const y=k(),h=k(),e=U({loading:!1,orgData:[],orgTreeData:[],queryParams:{id:-1,name:void 0,code:void 0},editOrgTitle:""});z(()=>{s(),g.on("submitRefresh",async()=>{var a;s(),(a=h.value)==null||a.initTreeData()})}),Q(()=>{g.off("submitRefresh")});const s=async()=>{e.loading=!0;var a=await D(T).apiSysOrgListGet(e.queryParams.id,e.queryParams.name,e.queryParams.code);e.orgData=a.data.result??[],e.loading=!1,e.queryParams.id==-1&&e.queryParams.name==null&&e.queryParams.code==null&&(e.orgTreeData=e.orgData)},C=()=>{e.queryParams.id=-1,e.queryParams.name=void 0,e.queryParams.code=void 0,s()},R=()=>{var a;e.editOrgTitle="添加机构",(a=y.value)==null||a.openDialog({status:1})},V=a=>{var i;e.editOrgTitle="编辑机构",(i=y.value)==null||i.openDialog(a)},B=a=>{G.confirm(`确定删除机构：【${a.name}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await D(T).apiSysOrgDeletePost({id:a.id}),I.success("删除成功"),g.emit("submitRefresh")}).catch(()=>{})},E=async a=>{e.queryParams.id=a.id,e.queryParams.name=void 0,e.queryParams.code=void 0,s()};return(a,i)=>{const w=l("el-col"),v=l("el-input"),_=l("el-form-item"),m=l("el-button"),K=l("el-button-group"),S=l("el-form"),b=l("el-card"),d=l("el-table-column"),P=l("el-tag"),N=l("el-table"),$=l("el-row"),f=q("auth"),A=q("loading");return n(),F("div",Y,[o($,{gutter:8,style:{width:"100%"}},{default:t(()=>[o(w,{span:4,xs:24},{default:t(()=>[o(L,{ref_key:"orgTreeRef",ref:h,onNodeClick:E},null,512)]),_:1}),o(w,{span:20,xs:24},{default:t(()=>[o(b,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:t(()=>[o(S,{model:e.queryParams,ref:"queryForm",inline:!0},{default:t(()=>[o(_,{label:"机构名称",prop:"name"},{default:t(()=>[o(v,{placeholder:"机构名称",clearable:"",onKeyup:O(s,["enter"]),modelValue:e.queryParams.name,"onUpdate:modelValue":i[0]||(i[0]=r=>e.queryParams.name=r)},null,8,["onKeyup","modelValue"])]),_:1}),o(_,{label:"机构编码",prop:"code"},{default:t(()=>[o(v,{placeholder:"机构编码",clearable:"",onKeyup:O(s,["enter"]),modelValue:e.queryParams.code,"onUpdate:modelValue":i[1]||(i[1]=r=>e.queryParams.code=r)},null,8,["onKeyup","modelValue"])]),_:1}),o(_,null,{default:t(()=>[o(K,null,{default:t(()=>[p((n(),c(m,{type:"primary",icon:"ele-Search",onClick:s},{default:t(()=>[u(" 查询 ")]),_:1})),[[f,"sysOrg:list"]]),o(m,{icon:"ele-Refresh",onClick:C},{default:t(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1}),o(_,null,{default:t(()=>[p((n(),c(m,{type:"primary",icon:"ele-Plus",onClick:R},{default:t(()=>[u(" 新增 ")]),_:1})),[[f,"sysOrg:add"]])]),_:1})]),_:1},8,["model"])]),_:1}),o(b,{shadow:"hover",style:{"margin-top":"8px"}},{default:t(()=>[p((n(),c(N,{data:e.orgData,style:{width:"100%"},"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},border:""},{default:t(()=>[o(d,{prop:"name",label:"机构名称","show-overflow-tooltip":""}),o(d,{prop:"code",label:"机构编码","show-overflow-tooltip":""}),o(d,{prop:"orderNo",label:"排序",width:"70",align:"center","show-overflow-tooltip":""}),o(d,{label:"状态",width:"70",align:"center","show-overflow-tooltip":""},{default:t(r=>[r.row.status===1?(n(),c(P,{key:0,type:"success"},{default:t(()=>[u("启用")]),_:1})):(n(),c(P,{key:1,type:"danger"},{default:t(()=>[u("禁用")]),_:1}))]),_:1}),o(d,{prop:"createTime",label:"修改时间",align:"center","show-overflow-tooltip":""}),o(d,{prop:"remark",label:"备注","show-overflow-tooltip":""}),o(d,{label:"操作",width:"140",fixed:"right",align:"center","show-overflow-tooltip":""},{default:t(r=>[p((n(),c(m,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:M=>V(r.row)},{default:t(()=>[u(" 编辑 ")]),_:2},1032,["onClick"])),[[f,"sysOrg:update"]]),p((n(),c(m,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:M=>B(r.row)},{default:t(()=>[u(" 删除 ")]),_:2},1032,["onClick"])),[[f,"sysOrg:delete"]])]),_:1})]),_:1},8,["data"])),[[A,e.loading]])]),_:1})]),_:1})]),_:1}),o(W,{ref_key:"editOrgRef",ref:y,title:e.editOrgTitle,orgData:e.orgTreeData},null,8,["title","orgData"])])}}});export{le as default};
