import{B as j,h as L,i as T,g as q,E as F}from"./index.a169e15e.js";import{K as O,a1 as N,k as E,ak as m,au as x,o as _,a as I,Y as a,S as n,T as b,R as w,W as f}from"./vue.e20a9695.js";import"./monacoEditor.48edecf2.js";const C=function(u){return{apiSysLogVisClearPost:async(e={})=>{const t="/api/sysLogVis/clear",l=new URL(t,"https://example.com");let s;u&&(s=u.baseOptions);const i={method:"POST",...s,...e},d={},P={},o=new URLSearchParams(l.search);for(const p in P)o.set(p,P[p]);for(const p in e.params)o.set(p,e.params[p]);l.search=new URLSearchParams(o).toString();let r=s&&s.headers?s.headers:{};return i.headers={...d,...r,...e.headers},{url:l.pathname+l.search+l.hash,options:i}},apiSysLogVisPagePost:async(e,t={})=>{const l="/api/sysLogVis/page",s=new URL(l,"https://example.com");let i;u&&(i=u.baseOptions);const d={method:"POST",...i,...t},P={},o={};P["Content-Type"]="application/json-patch+json";const r=new URLSearchParams(s.search);for(const h in o)r.set(h,o[h]);for(const h in t.params)r.set(h,t.params[h]);s.search=new URLSearchParams(r).toString();let p=i&&i.headers?i.headers:{};d.headers={...P,...p,...t.headers};const g=typeof e!="string"||d.headers["Content-Type"]==="application/json";return d.data=g?JSON.stringify(e!==void 0?e:{}):e||"",{url:s.pathname+s.search+s.hash,options:d}}}},k=function(u){return{async apiSysLogVisClearPost(e){const t=await C(u).apiSysLogVisClearPost(e);return(l=L,s=T)=>{const i={...t.options,url:s+t.url};return l.request(i)}},async apiSysLogVisPagePost(e,t){const l=await C(u).apiSysLogVisPagePost(e,t);return(s=L,i=T)=>{const d={...l.options,url:i+l.url};return s.request(d)}}}};class A extends j{async apiSysLogVisClearPost(e){return k(this.configuration).apiSysLogVisClearPost(e).then(t=>t(this.axios,this.basePath))}async apiSysLogVisPagePost(e,t){return k(this.configuration).apiSysLogVisPagePost(e,t).then(l=>l(this.axios,this.basePath))}}const Q={class:"sys-vislog-container"},H=O({name:"sysVisLog"}),W=O({...H,setup(u){const e=N({loading:!1,queryParams:{startTime:void 0,endTime:void 0},tableParams:{page:1,pageSize:20,total:0},logData:[]});E(async()=>{t()});const t=async()=>{var p,g;e.queryParams.startTime==null&&(e.queryParams.startTime=void 0),e.queryParams.endTime==null&&(e.queryParams.endTime=void 0),e.loading=!0;let o=Object.assign(e.queryParams,e.tableParams);var r=await q(A).apiSysLogVisPagePost(o);e.logData=((p=r.data.result)==null?void 0:p.items)??[],e.tableParams.total=(g=r.data.result)==null?void 0:g.total,e.loading=!1},l=()=>{e.queryParams.startTime=void 0,e.queryParams.endTime=void 0,t()},s=async()=>{e.loading=!0,await q(A).apiSysLogVisClearPost(),e.loading=!1,F.success("清空成功"),t()},i=o=>{e.tableParams.pageSize=o,t()},d=o=>{e.tableParams.page=o,t()},P=[{text:"今天",value:new Date},{text:"昨天",value:()=>{const o=new Date;return o.setTime(o.getTime()-3600*1e3*24),o}},{text:"上周",value:()=>{const o=new Date;return o.setTime(o.getTime()-3600*1e3*24*7),o}}];return(o,r)=>{const p=m("el-date-picker"),g=m("el-form-item"),h=m("el-button"),z=m("el-button-group"),R=m("el-form"),V=m("el-card"),c=m("el-table-column"),S=m("el-tag"),U=m("el-table"),D=m("el-pagination"),v=x("auth"),B=x("loading");return _(),I("div",Q,[a(V,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:n(()=>[a(R,{model:e.queryParams,ref:"queryForm",inline:!0},{default:n(()=>[a(g,{label:"开始时间",prop:"name"},{default:n(()=>[a(p,{modelValue:e.queryParams.startTime,"onUpdate:modelValue":r[0]||(r[0]=y=>e.queryParams.startTime=y),type:"datetime",placeholder:"开始时间",shortcuts:P},null,8,["modelValue"])]),_:1}),a(g,{label:"结束时间",prop:"code"},{default:n(()=>[a(p,{modelValue:e.queryParams.endTime,"onUpdate:modelValue":r[1]||(r[1]=y=>e.queryParams.endTime=y),type:"datetime",placeholder:"结束时间",shortcuts:P},null,8,["modelValue"])]),_:1}),a(g,null,{default:n(()=>[a(z,null,{default:n(()=>[b((_(),w(h,{type:"primary",icon:"ele-Search",onClick:t},{default:n(()=>[f(" 查询 ")]),_:1})),[[v,"sysVislog:page"]]),a(h,{icon:"ele-Refresh",onClick:l},{default:n(()=>[f(" 重置 ")]),_:1})]),_:1})]),_:1}),a(g,null,{default:n(()=>[b((_(),w(h,{icon:"ele-DeleteFilled",type:"danger",onClick:s},{default:n(()=>[f(" 清空 ")]),_:1})),[[v,"sysVislog:clear"]])]),_:1})]),_:1},8,["model"])]),_:1}),a(V,{shadow:"hover",style:{"margin-top":"8px"}},{default:n(()=>[b((_(),w(U,{data:e.logData,style:{width:"100%"},border:""},{default:n(()=>[a(c,{type:"index",label:"序号",width:"55",align:"center"}),a(c,{prop:"displayTitle",label:"显示名称",width:"150","show-overflow-tooltip":""}),a(c,{prop:"actionName",label:"方法名称",width:"100","show-overflow-tooltip":""}),a(c,{prop:"account",label:"账号名称",width:"100","show-overflow-tooltip":""}),a(c,{prop:"realName",label:"真实姓名",width:"100","show-overflow-tooltip":""}),a(c,{prop:"remoteIp",label:"IP地址",width:"120","show-overflow-tooltip":""}),a(c,{prop:"location",label:"登录地点",width:"150","show-overflow-tooltip":""}),a(c,{prop:"browser",label:"浏览器","show-overflow-tooltip":""}),a(c,{prop:"os",label:"操作系统",width:"150","show-overflow-tooltip":""}),a(c,{prop:"status",label:"状态",width:"70",align:"center","show-overflow-tooltip":""},{default:n(y=>[y.row.status==="200"?(_(),w(S,{key:0,type:"success"},{default:n(()=>[f("成功")]),_:1})):(_(),w(S,{key:1,type:"danger"},{default:n(()=>[f("失败")]),_:1}))]),_:1}),a(c,{prop:"elapsed",label:"耗时(ms)",width:"100",align:"center","show-overflow-tooltip":""}),a(c,{prop:"logDateTime",label:"日志时间",width:"160",align:"center",fixed:"right","show-overflow-tooltip":""})]),_:1},8,["data"])),[[B,e.loading]]),a(D,{currentPage:e.tableParams.page,"onUpdate:currentPage":r[2]||(r[2]=y=>e.tableParams.page=y),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":r[3]||(r[3]=y=>e.tableParams.pageSize=y),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:i,onCurrentChange:d,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1})])}}});export{W as default};
