import{K as N,a1 as F,k as H,a0 as I,ak as i,au as b,o as p,a as M,Y as t,S as a,ac as A,W as r,T as w,R as c,X as L,u as Q,b as v}from"./vue.e20a9695.js";import{c as $}from"./commonFunction.71cd4659.js";import{g as h,e as j}from"./index.32ca2701.js";import{S as P}from"./sys-notice-api.8c7d9dc6.js";import"./formatTime.29ac8c52.js";import"./monacoEditor.48edecf2.js";const E={class:"notice-container"},G=["innerHTML"],W={class:"dialog-footer"},X=N({name:"notice"}),le=N({...X,setup(Y){const{removeHtml:S}=$(),e=F({loading:!1,noticeData:[],queryParams:{title:void 0,type:void 0},tableParams:{page:1,pageSize:10,total:0},editNoticeTitle:"",dialogVisible:!1,content:""});H(async()=>{d()}),I(()=>{});const d=async()=>{var l,u;e.loading=!0;var n=await h(P).apiSysNoticePageReceivedGet(e.queryParams.title,e.queryParams.type,e.tableParams.page,e.tableParams.pageSize);e.noticeData=((l=n.data.result)==null?void 0:l.items)??[],e.tableParams.total=(u=n.data.result)==null?void 0:u.total,e.loading=!1},V=()=>{e.queryParams.title=void 0,e.queryParams.type=void 0,d()},k=n=>{e.tableParams.pageSize=n,d()},C=n=>{e.tableParams.page=n,d()},x=async n=>{e.content=n.sysNotice.content,e.dialogVisible=!0,n.readStatus=1,j.emit("noticeRead",n.sysNotice.id),await h(P).apiSysNoticeSetReadPost({id:n.sysNotice.id})},z=({row:n,rowIndex:l})=>n.readStatus===1?"info-row":"";return(n,l)=>{const u=i("el-input"),y=i("el-form-item"),g=i("el-option"),q=i("el-select"),m=i("el-button"),D=i("el-form"),f=i("el-card"),s=i("el-table-column"),_=i("el-tag"),T=i("el-table"),U=i("el-pagination"),R=i("el-dialog"),B=b("auth"),K=b("loading");return p(),M("div",E,[t(f,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:a(()=>[t(D,{model:e.queryParams,ref:"queryForm",inline:!0},{default:a(()=>[t(y,{label:"标题",prop:"title"},{default:a(()=>[t(u,{placeholder:"标题",clearable:"",onKeyup:A(d,["enter"]),modelValue:e.queryParams.title,"onUpdate:modelValue":l[0]||(l[0]=o=>e.queryParams.title=o)},null,8,["onKeyup","modelValue"])]),_:1}),t(y,{label:"类型",prop:"type"},{default:a(()=>[t(q,{modelValue:e.queryParams.type,"onUpdate:modelValue":l[1]||(l[1]=o=>e.queryParams.type=o),placeholder:"类型",clearable:"",style:{width:"100%"}},{default:a(()=>[t(g,{label:"通知",value:1}),t(g,{label:"公告",value:2})]),_:1},8,["modelValue"])]),_:1}),t(y,null,{default:a(()=>[t(m,{icon:"ele-Refresh",onClick:V},{default:a(()=>[r(" 重置 ")]),_:1}),w((p(),c(m,{type:"primary",icon:"ele-Search",onClick:d},{default:a(()=>[r(" 查询 ")]),_:1})),[[B,"sysNotice:page"]])]),_:1})]),_:1},8,["model"])]),_:1}),t(f,{shadow:"hover",style:{"margin-top":"8px"}},{default:a(()=>[w((p(),c(T,{data:e.noticeData,style:{width:"100%"},border:"","row-class-name":z},{default:a(()=>[t(s,{type:"index",label:"序号",width:"55",align:"center"}),t(s,{prop:"sysNotice.title",label:"标题","show-overflow-tooltip":""}),t(s,{prop:"sysNotice.content",label:"内容","show-overflow-tooltip":""},{default:a(o=>[r(L(Q(S)(o.row.sysNotice.content)),1)]),_:1}),t(s,{prop:"sysNotice.type",label:"类型",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.sysNotice.type===1?(p(),c(_,{key:0},{default:a(()=>[r(" 通知 ")]),_:1})):(p(),c(_,{key:1,type:"warning"},{default:a(()=>[r(" 公告 ")]),_:1}))]),_:1}),t(s,{prop:"sysNotice.createTime",label:"创建时间",align:"center","show-overflow-tooltip":""}),t(s,{prop:"readStatus",label:"阅读状态",width:"100",align:"center","show-overflow-tooltip":""},{default:a(o=>[o.row.readStatus===1?(p(),c(_,{key:0,type:"info"},{default:a(()=>[r(" 已读 ")]),_:1})):(p(),c(_,{key:1,type:"danger"},{default:a(()=>[r(" 未读 ")]),_:1}))]),_:1}),t(s,{prop:"sysNotice.publicUserName",label:"发布者",align:"center","show-overflow-tooltip":""}),t(s,{prop:"sysNotice.publicTime",label:"发布时间",align:"center","show-overflow-tooltip":""}),t(s,{label:"操作",width:"80",fixed:"right",align:"center","show-overflow-tooltip":""},{default:a(o=>[t(m,{icon:"ele-InfoFilled",size:"small",text:"",type:"primary",onClick:J=>x(o.row)},{default:a(()=>[r(" 详情 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,e.loading]]),t(U,{currentPage:e.tableParams.page,"onUpdate:currentPage":l[2]||(l[2]=o=>e.tableParams.page=o),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":l[3]||(l[3]=o=>e.tableParams.pageSize=o),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:k,onCurrentChange:C,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1}),t(R,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=o=>e.dialogVisible=o),title:"消息详情",draggable:"",width:"769px"},{footer:a(()=>[v("span",W,[t(m,{type:"primary",onClick:l[4]||(l[4]=o=>e.dialogVisible=!1)},{default:a(()=>[r("确认")]),_:1})])]),default:a(()=>[v("p",{innerHTML:e.content},null,8,G)]),_:1},8,["modelValue"])])}}});export{le as default};
