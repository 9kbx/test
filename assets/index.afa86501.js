import{_ as k}from"./monacoEditor.9170b963.js";import{e as v,f as h,z as D,E as w}from"./index.96b44ad7.js";import{_ as I,S as m}from"./editConfig.vue_vue_type_script_setup_true_name_sysEditConfig_lang.b57decbb.js";import{a as M}from"./authFunction.54629d65.js";import{K as B,aC as S,r as x,a1 as T,k as j,a0 as H,ak as y,au as K,o as c,a as U,Y as g,S as o,u as E,P as W,T as _,R as p,W as u,V as Y,n as J}from"./vue.e20a9695.js";const Q={class:"sys-config-container"},X=B({name:"sysConfig"}),re=B({...X,setup(Z){const L=S(()=>k(()=>import("./index.7f925098.js"),["./index.7f925098.js","./vue.e20a9695.js","./sortable.esm.be94e56d.js","./index.96b44ad7.js","./monacoEditor.9170b963.js","./monacoEditor.613065c2.css","./index.32da498c.css","./_plugin-vue_export-helper.c27b6911.js","./index.a489f139.css"],import.meta.url)),P=S(()=>k(()=>import("./search.3d736c1b.js"),["./search.3d736c1b.js","./vue.e20a9695.js","./_plugin-vue_export-helper.c27b6911.js","./search.0fb14788.css"],import.meta.url)),C=x(),d=x(),a=T({editConfigTitle:"",selectlist:[],groupList:[]}),l=T({tableData:{columns:[{prop:"name",width:160,label:"配置名称",align:"center",sortable:"custom",isCheck:!0,hideCheck:!0},{prop:"code",width:120,label:"配置编码",align:"center",toolTip:!0,sortable:"custom",isCheck:!0},{prop:"value",width:120,label:"属性值",align:"center",sortable:"custom",isCheck:!0},{prop:"sysFlag",width:120,label:"内置参数",align:"center",sortable:"custom",isCheck:!0},{prop:"groupCode",width:120,label:"分组编码",align:"center",sortable:"custom",isCheck:!0},{prop:"orderNo",width:80,label:"排序",align:"center",sortable:"custom",isCheck:!0},{prop:"remark",label:"备注",align:"",headerAlign:"center",sortable:"custom",showOverflowTooltip:!0,isCheck:!0},{prop:"action",width:150,label:"操作",type:"action",align:"center",isCheck:!0,fixed:"right",hideCheck:!0}],config:{isStripe:!0,isBorder:!1,isSerialNo:!0,isSelection:!0,showSelection:M("sysConfig:batchDelete"),pageSize:10,hideExport:!1,exportFileName:"系统参数"},search:[{label:"配置名称",prop:"name",placeholder:"搜索配置名称",required:!1,type:"input"},{label:"配置编码",prop:"code",placeholder:"搜索配置编码",required:!1,type:"input"}],param:{},defaultSort:{prop:"orderNo",order:"ascending"}}}),R=e=>h(m).apiSysConfigPagePost(e).then(t=>t.data),A=e=>(e.forEach(t=>{t.sysFlag=t.sysFlag==1?"是":"否"}),e),F=e=>{l.tableData.columns=e},N=e=>{l.tableData.param=Object.assign({},l.tableData.param,{...e}),J(()=>{d.value.pageReset()})},b=async()=>{var s;const e=await h(m).apiSysConfigGroupListGet(),t={label:"分组编码",prop:"groupCode",placeholder:"请选择",required:!1,type:"select",options:[]};a.groupList=e.data.result??[],(s=e.data.result)==null||s.forEach(n=>{var i;(i=t.options)==null||i.push({label:n,value:n})});let r=l.tableData.search.filter(n=>n.prop=="groupCode");r.length==0?l.tableData.search.push(t):r[0]=t},V=e=>{a.selectlist=e};j(async()=>{b(),v.on("submitRefresh",()=>{d.value.handleList(),b()})}),H(()=>{v.off("submitRefresh")});const $=()=>{var e;a.editConfigTitle="添加配置",(e=C.value)==null||e.openDialog({sysFlag:2})},z=e=>{var t;a.editConfigTitle="编辑配置",(t=C.value)==null||t.openDialog(e)},O=e=>{D.confirm(`确定删除配置：【${e.name}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await h(m).apiSysConfigDeletePost({id:e.id}),d.value.handleList(),w.success("删除成功")}).catch(()=>{})},q=()=>{if(a.selectlist.length==0)return!1;D.confirm(`确定批量删除【${a.selectlist[0].name}】等${a.selectlist.length}个配置?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{var r;const e=a.selectlist.map(s=>s.id);var t=await h(m).apiSysConfigBatchDeletePost({ids:e});d.value.pageReset(),w.success((r=t.data.result)==null?void 0:r.toString())}).catch(()=>{})};return(e,t)=>{const r=y("el-card"),s=y("el-button"),n=y("el-tag"),i=K("auth");return c(),U("div",Q,[g(r,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:o(()=>[g(E(P),{search:l.tableData.search,onSearch:N},null,8,["search"])]),_:1}),g(r,{shadow:"hover",style:{"margin-top":"8px"}},{default:o(()=>[g(E(L),W({ref_key:"tableRef",ref:d},l.tableData,{getData:R,exportChangeData:A,onSortHeader:F,onSelectionChange:V}),{command:o(()=>[_((c(),p(s,{type:"primary",icon:"ele-Plus",onClick:$},{default:o(()=>[u(" 新增 ")]),_:1})),[[i,"sysConfig:add"]]),a.selectlist.length>0?_((c(),p(s,{key:0,type:"danger",icon:"ele-Delete",onClick:q},{default:o(()=>[u(" 批量删除 ")]),_:1})),[[i,"sysConfig:batchDelete"]]):Y("",!0)]),sysFlag:o(f=>[f.row.sysFlag===1?(c(),p(n,{key:0},{default:o(()=>[u(" 是 ")]),_:1})):(c(),p(n,{key:1,type:"danger"},{default:o(()=>[u(" 否 ")]),_:1}))]),action:o(f=>[_((c(),p(s,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:G=>z(f.row)},{default:o(()=>[u(" 编辑 ")]),_:2},1032,["onClick"])),[[i,"sysConfig:update"]]),_((c(),p(s,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:G=>O(f.row)},{default:o(()=>[u(" 删除 ")]),_:2},1032,["onClick"])),[[i,"sysConfig:delete"]])]),_:1},16)]),_:1}),g(I,{ref_key:"editConfigRef",ref:C,title:a.editConfigTitle,groupList:a.groupList},null,8,["title","groupList"])])}}});export{re as default};
