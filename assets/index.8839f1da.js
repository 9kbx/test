import{B,i as D,j as x,f as L,E as j}from"./index.26b2f771.js";import{K as k,a1 as F,k as E,ak as g,au as T,o as _,a as Q,Y as t,S as p,T as P,R as b,W as w}from"./vue.e20a9695.js";import{_ as H}from"./_plugin-vue_export-helper.c27b6911.js";import"./monacoEditor.48edecf2.js";const q=function(d){return{apiSysLogDiffClearPost:async(e={})=>{const a="/api/sysLogDiff/clear",l=new URL(a,"https://example.com");let s;d&&(s=d.baseOptions);const n={method:"POST",...s,...e},c={},h={},o=new URLSearchParams(l.search);for(const i in h)o.set(i,h[i]);for(const i in e.params)o.set(i,e.params[i]);l.search=new URLSearchParams(o).toString();let r=s&&s.headers?s.headers:{};return n.headers={...c,...r,...e.headers},{url:l.pathname+l.search+l.hash,options:n}},apiSysLogDiffPagePost:async(e,a={})=>{const l="/api/sysLogDiff/page",s=new URL(l,"https://example.com");let n;d&&(n=d.baseOptions);const c={method:"POST",...n,...a},h={},o={};h["Content-Type"]="application/json-patch+json";const r=new URLSearchParams(s.search);for(const f in o)r.set(f,o[f]);for(const f in a.params)r.set(f,a.params[f]);s.search=new URLSearchParams(r).toString();let i=n&&n.headers?n.headers:{};c.headers={...h,...i,...a.headers};const u=typeof e!="string"||c.headers["Content-Type"]==="application/json";return c.data=u?JSON.stringify(e!==void 0?e:{}):e||"",{url:s.pathname+s.search+s.hash,options:c}}}},C=function(d){return{async apiSysLogDiffClearPost(e){const a=await q(d).apiSysLogDiffClearPost(e);return(l=D,s=x)=>{const n={...a.options,url:s+a.url};return l.request(n)}},async apiSysLogDiffPagePost(e,a){const l=await q(d).apiSysLogDiffPagePost(e,a);return(s=D,n=x)=>{const c={...l.options,url:n+l.url};return s.request(c)}}}};class V extends B{async apiSysLogDiffClearPost(e){return C(this.configuration).apiSysLogDiffClearPost(e).then(a=>a(this.axios,this.basePath))}async apiSysLogDiffPagePost(e,a){return C(this.configuration).apiSysLogDiffPagePost(e,a).then(l=>l(this.axios,this.basePath))}}const I={class:"sys-difflog-container"},N=k({name:"sysDiffLog"}),M=k({...N,setup(d){const e=F({loading:!1,queryParams:{startTime:void 0,endTime:void 0},tableParams:{page:1,pageSize:10,total:0},logData:[]});E(async()=>{a()});const a=async()=>{var i,u;e.queryParams.startTime==null&&(e.queryParams.startTime=void 0),e.queryParams.endTime==null&&(e.queryParams.endTime=void 0),e.loading=!0;let o=Object.assign(e.queryParams,e.tableParams);var r=await L(V).apiSysLogDiffPagePost(o);e.logData=((i=r.data.result)==null?void 0:i.items)??[],e.tableParams.total=(u=r.data.result)==null?void 0:u.total,e.loading=!1},l=()=>{e.queryParams.startTime=void 0,e.queryParams.endTime=void 0,a()},s=async()=>{e.loading=!0,await L(V).apiSysLogDiffClearPost(),e.loading=!1,j.success("清空成功"),a()},n=o=>{e.tableParams.pageSize=o,a()},c=o=>{e.tableParams.page=o,a()},h=[{text:"今天",value:new Date},{text:"昨天",value:()=>{const o=new Date;return o.setTime(o.getTime()-3600*1e3*24),o}},{text:"上周",value:()=>{const o=new Date;return o.setTime(o.getTime()-3600*1e3*24*7),o}}];return(o,r)=>{const i=g("el-date-picker"),u=g("el-form-item"),f=g("el-button"),A=g("el-button-group"),O=g("el-form"),S=g("el-card"),m=g("el-table-column"),z=g("el-table"),R=g("el-pagination"),v=T("auth"),U=T("loading");return _(),Q("div",I,[t(S,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:p(()=>[t(O,{model:e.queryParams,ref:"queryForm",inline:!0},{default:p(()=>[t(u,{label:"开始时间",prop:"name"},{default:p(()=>[t(i,{modelValue:e.queryParams.startTime,"onUpdate:modelValue":r[0]||(r[0]=y=>e.queryParams.startTime=y),type:"datetime",placeholder:"开始时间",shortcuts:h},null,8,["modelValue"])]),_:1}),t(u,{label:"结束时间",prop:"code"},{default:p(()=>[t(i,{modelValue:e.queryParams.endTime,"onUpdate:modelValue":r[1]||(r[1]=y=>e.queryParams.endTime=y),type:"datetime",placeholder:"结束时间",shortcuts:h},null,8,["modelValue"])]),_:1}),t(u,null,{default:p(()=>[t(A,null,{default:p(()=>[P((_(),b(f,{type:"primary",icon:"ele-Search",onClick:a},{default:p(()=>[w(" 查询 ")]),_:1})),[[v,"sysDifflog:page"]]),t(f,{icon:"ele-Refresh",onClick:l},{default:p(()=>[w(" 重置 ")]),_:1})]),_:1})]),_:1}),t(u,null,{default:p(()=>[P((_(),b(f,{icon:"ele-DeleteFilled",type:"danger",onClick:s},{default:p(()=>[w(" 清空 ")]),_:1})),[[v,"sysDifflog:clear"]])]),_:1})]),_:1},8,["model"])]),_:1}),t(S,{shadow:"hover",style:{"margin-top":"8px"}},{default:p(()=>[P((_(),b(z,{data:e.logData,style:{width:"100%"},border:""},{default:p(()=>[t(m,{type:"index",label:"序号",width:"55",align:"center"}),t(m,{prop:"diffType",label:"差异操作","show-overflow-tooltip":""}),t(m,{prop:"sql",label:"Sql语句","show-overflow-tooltip":""}),t(m,{prop:"parameters",label:"参数","show-overflow-tooltip":""}),t(m,{prop:"elapsed",label:"耗时(ms)","show-overflow-tooltip":""}),t(m,{prop:"message",label:"日志消息","show-overflow-tooltip":""}),t(m,{prop:"beforeData",label:"操作前记录","show-overflow-tooltip":""}),t(m,{prop:"afterData",label:"操作后记录","show-overflow-tooltip":""}),t(m,{prop:"businessData",label:"业务对象","show-overflow-tooltip":""}),t(m,{prop:"createTime",label:"操作时间",align:"center","show-overflow-tooltip":""})]),_:1},8,["data"])),[[U,e.loading]]),t(R,{currentPage:e.tableParams.page,"onUpdate:currentPage":r[2]||(r[2]=y=>e.tableParams.page=y),"page-size":e.tableParams.pageSize,"onUpdate:pageSize":r[3]||(r[3]=y=>e.tableParams.pageSize=y),total:e.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:n,onCurrentChange:c,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1})])}}});const G=H(M,[["__scopeId","data-v-86bc33f4"]]);export{G as default};
