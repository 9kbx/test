import{_ as N}from"./monacoEditor.48edecf2.js";import{K as R,aC as K,aD as L,aG as M,r as x,a1 as G,k as O,l as z,ak as l,au as j,o as I,a as J,Y as a,S as s,b as d,M as X,T as P,Z as Y,ac as Z,R as H,X as k,u as Q,F as W}from"./vue.e20a9695.js";import{a as ee,f as y,q as oe,E as h,S as ae,r as te,t as se,N as ne,x as V}from"./index.09fc6580.js";import{a as re}from"./formatTime.29ac8c52.js";import{l as le}from"./logo-mini.4b38212b.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";const ce={class:"login-content-code"},ue=["src"],de={class:"font12 mt30 login-animation4 login-msg"},me={class:"dialog-header"},pe=R({name:"loginAccount"}),fe=R({...pe,setup(ge){const S=K(()=>N(()=>import("./dragVerifyImgRotate.a497ac43.js"),["assets/dragVerifyImgRotate.a497ac43.js","assets/_plugin-vue_export-helper.c27b6911.js","assets/vue.e20a9695.js","assets/dragVerifyImgRotate.bf30feaa.css"])),{t:F}=ee(),m=L(),w=M(),b=x(),v=x(null),e=G({isShowPassword:!1,ruleForm:{account:"superadmin",password:"123456",code:"",codeId:0},rules:{account:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},loading:{signIn:!1},captchaImage:"",rotateVerifyVisible:!1,rotateVerifyImg:le,secondVerEnabled:!0,captchaEnabled:!0,isPassRotate:!1});O(async()=>{var t=await y(V).apiSysAuthLoginConfigGet();e.secondVerEnabled=t.data.result.secondVerEnabled??!0,e.captchaEnabled=t.data.result.captchaEnabled??!0,p()});const p=async()=>{var o,r;e.ruleForm.code="";var t=await y(V).apiSysAuthCaptchaGet();e.captchaImage="data:text/html;base64,"+((o=t.data.result)==null?void 0:o.img),e.ruleForm.codeId=(r=t.data.result)==null?void 0:r.id},E=z(()=>re(new Date)),f=async()=>{b.value.validate(async t=>{var i,c;if(!t)return!1;const[o,r]=await oe(y(V).apiSysAuthLoginPost(e.ruleForm));if(o){p();return}if(((i=r.data.result)==null?void 0:i.accessToken)==null){p(),h.error("登录失败，请检查账号！");return}e.loading.signIn=!0,ae.set("token",(c=r.data.result)==null?void 0:c.accessToken);const u=await te();C(u)})},C=t=>{var o,r,u,i;if(t)h.warning("抱歉，您没有登录权限"),se();else{let c=E.value;(o=m.query)!=null&&o.redirect?w.push({path:(r=m.query)==null?void 0:r.redirect,query:Object.keys((u=m.query)==null?void 0:u.params).length>0?JSON.parse((i=m.query)==null?void 0:i.params):""}):w.push("/");const g=F("message.signInText");h.success(`${c}，${g}`),ne.start()}e.loading.signIn=!1},T=()=>{var t;e.rotateVerifyVisible=!0,e.isPassRotate=!1,(t=v.value)==null||t.reset()},A=()=>{e.rotateVerifyVisible=!1,e.isPassRotate=!0,f()};return(t,o)=>{const r=l("ele-User"),u=l("el-icon"),i=l("el-input"),c=l("el-form-item"),g=l("ele-Unlock"),q=l("ele-Position"),_=l("el-col"),U=l("el-button"),D=l("el-form"),$=l("el-dialog"),B=j("waves");return I(),J(W,null,[a(D,{ref_key:"ruleFormRef",ref:b,model:e.ruleForm,size:"large",rules:e.rules,class:"login-content-form"},{default:s(()=>[a(c,{class:"login-animation1",prop:"account"},{default:s(()=>[a(i,{text:"",placeholder:"请输入账号",modelValue:e.ruleForm.account,"onUpdate:modelValue":o[0]||(o[0]=n=>e.ruleForm.account=n),clearable:"",autocomplete:"off"},{prefix:s(()=>[a(u,null,{default:s(()=>[a(r)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(c,{class:"login-animation2",prop:"password"},{default:s(()=>[a(i,{type:e.isShowPassword?"text":"password",placeholder:"请输入密码",modelValue:e.ruleForm.password,"onUpdate:modelValue":o[2]||(o[2]=n=>e.ruleForm.password=n),autocomplete:"off"},{prefix:s(()=>[a(u,null,{default:s(()=>[a(g)]),_:1})]),suffix:s(()=>[d("i",{class:X(["iconfont el-input__icon login-content-password",e.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:o[1]||(o[1]=n=>e.isShowPassword=!e.isShowPassword)},null,2)]),_:1},8,["type","modelValue"])]),_:1}),P(a(c,{class:"login-animation3",prop:"captcha"},{default:s(()=>[a(_,{span:15},{default:s(()=>[a(i,{text:"",maxlength:"4",placeholder:t.$t("message.account.accountPlaceholder3"),modelValue:e.ruleForm.code,"onUpdate:modelValue":o[3]||(o[3]=n=>e.ruleForm.code=n),clearable:"",autocomplete:"off",onKeyup:Z(f,["enter","native"])},{prefix:s(()=>[a(u,null,{default:s(()=>[a(q)]),_:1})]),_:1},8,["placeholder","modelValue","onKeyup"])]),_:1}),a(_,{span:1}),a(_,{span:8},{default:s(()=>[d("div",ce,[d("img",{class:"login-content-code-img",onClick:p,width:"130px",height:"38px",src:e.captchaImage,style:{cursor:"pointer"}},null,8,ue)])]),_:1})]),_:1},512),[[Y,e.captchaEnabled]]),a(c,{class:"login-animation4"},{default:s(()=>[P((I(),H(U,{type:"primary",class:"login-content-submit",round:"",onClick:o[4]||(o[4]=n=>e.secondVerEnabled?T():f()),loading:e.loading.signIn},{default:s(()=>[d("span",null,k(t.$t("message.account.accountBtnText")),1)]),_:1},8,["loading"])),[[B]])]),_:1}),d("div",de,k(t.$t("message.mobile.msgText")),1)]),_:1},8,["model","rules"]),d("div",me,[a($,{modelValue:e.rotateVerifyVisible,"onUpdate:modelValue":o[6]||(o[6]=n=>e.rotateVerifyVisible=n),"show-close":!1},{default:s(()=>[a(Q(S),{ref_key:"dragRef",ref:v,imgsrc:e.rotateVerifyImg,isPassing:e.isPassRotate,"onUpdate:isPassing":o[5]||(o[5]=n=>e.isPassRotate=n),text:"请按住滑块拖动",successText:"验证通过",handlerIcon:"fa fa-angle-double-right",successIcon:"fa fa-hand-peace-o",onPasscallback:A},null,8,["imgsrc","isPassing"])]),_:1},8,["modelValue"])])],64)}}});const ve=ie(fe,[["__scopeId","data-v-9dcce824"]]);export{ve as default};
