import{f as i,D as O,e as z}from"./index.96b44ad7.js";import{S as _}from"./sys-code-gen-api.ab3328b6.js";import{S as E}from"./sys-dict-data-api.8472452f.js";import{K as C,r as R,a1 as H,k as J,ak as s,o as m,a as c,Y as e,S as o,b as g,X as y,W as w,F as S,ab as v,V as K,R as V}from"./vue.e20a9695.js";const Q={class:"sys-editCodeGen-container"},W={style:{color:"#fff"}},X={key:0},Y={class:"dialog-footer"},$=C({name:"sysEditCodeGen"}),ae=C({...$,props:{title:String},setup(N,{expose:G}){const k=N,F=R(),l=H({isShowDialog:!1,ruleForm:{},tableData:[],dbData:[],menuData:[],codeGenTypeList:[]});J(async()=>{var d=await i(_).apiSysCodeGenDatabaseListGet();l.dbData=d.data.result;let t=await i(O).apiSysMenuListGet();l.menuData=t.data.result??[];let p=await i(E).apiSysDictDataDataListCodeGet("code_gen_create_type");l.codeGenTypeList=p.data.result});const T=async()=>{if(l.ruleForm.configId==="")return;let d=await i(_).apiSysCodeGenTableListConfigIdGet(l.ruleForm.configId);l.tableData=d.data.result??[];let t=l.dbData.filter(p=>p.configId==l.ruleForm.configId);l.ruleForm.connectionString=t[0].connectionString,l.ruleForm.dbType=t[0].dbType.toString()},I=d=>{l.ruleForm=JSON.parse(JSON.stringify(d)),l.isShowDialog=!0},U=()=>{z.emit("submitRefresh"),l.isShowDialog=!1},h=()=>{l.isShowDialog=!1},L=()=>{F.value.validate(async d=>{d&&(l.ruleForm.id!=null&&l.ruleForm.id>0?await i(_).apiSysCodeGenUpdatePost(l.ruleForm):await i(_).apiSysCodeGenAddPost(l.ruleForm),U())})};return G({openDialog:I}),(d,t)=>{const p=s("ele-Edit"),P=s("el-icon"),r=s("el-option"),b=s("el-select"),n=s("el-form-item"),u=s("el-col"),f=s("el-input"),q=s("el-cascader"),A=s("el-row"),B=s("el-form"),D=s("el-button"),M=s("el-dialog");return m(),c("div",Q,[e(M,{modelValue:l.isShowDialog,"onUpdate:modelValue":t[10]||(t[10]=a=>l.isShowDialog=a),draggable:"",width:"700px"},{header:o(()=>[g("div",W,[e(P,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:o(()=>[e(p)]),_:1}),g("span",null,y(k.title),1)])]),footer:o(()=>[g("span",Y,[e(D,{onClick:h,size:"default"},{default:o(()=>[w("取 消")]),_:1}),e(D,{type:"primary",onClick:L,size:"default"},{default:o(()=>[w("确 定")]),_:1})])]),default:o(()=>[e(B,{model:l.ruleForm,ref_key:"ruleFormRef",ref:F,size:"default","label-width":"80px"},{default:o(()=>[e(A,{gutter:35},{default:o(()=>[e(u,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[e(n,{label:"库定位器",prop:"configId"},{default:o(()=>[e(b,{modelValue:l.ruleForm.configId,"onUpdate:modelValue":t[0]||(t[0]=a=>l.ruleForm.configId=a),placeholder:"库名",filterable:"",onChange:t[1]||(t[1]=a=>T()),class:"w100"},{default:o(()=>[(m(!0),c(S,null,v(l.dbData,a=>(m(),V(r,{key:a.configId,label:a.configId,value:a.configId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[e(n,{label:"库类型",prop:"dbType",rules:[{required:!0,message:"描述不能为空",trigger:"blur"}]},{default:o(()=>[e(b,{modelValue:l.ruleForm.dbType,"onUpdate:modelValue":t[2]||(t[2]=a=>l.ruleForm.dbType=a),placeholder:"数据库类型",clearable:"",disabled:"",class:"w100"},{default:o(()=>[e(r,{label:"MySql",value:"0"}),e(r,{label:"SqlServer",value:"1"}),e(r,{label:"Sqlite",value:"2"}),e(r,{label:"Oracle",value:"3"}),e(r,{label:"PostgreSQL",value:"4"}),e(r,{label:"Dm",value:"5"}),e(r,{label:"Kdbndp",value:"6"}),e(r,{label:"Oscar",value:"7"}),e(r,{label:"MySqlConnector",value:"8"}),e(r,{label:"Access",value:"9"}),e(r,{label:"OpenGauss",value:"10"}),e(r,{label:"QuestDB",value:"11"}),e(r,{label:"HG",value:"12"}),e(r,{label:"ClickHouse",value:"13"}),e(r,{label:"GBase",value:"14"}),e(r,{label:"Custom",value:"900"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:o(()=>[e(n,{label:"库地址",prop:"connectionString"},{default:o(()=>[e(f,{modelValue:l.ruleForm.connectionString,"onUpdate:modelValue":t[3]||(t[3]=a=>l.ruleForm.connectionString=a),disabled:"",clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[e(n,{label:"生成表",prop:"tableName",rules:[{required:!0,message:"生成表不能为空",trigger:"blur"}]},{default:o(()=>[e(b,{modelValue:l.ruleForm.tableName,"onUpdate:modelValue":t[4]||(t[4]=a=>l.ruleForm.tableName=a),filterable:"",clearable:"",class:"w100"},{default:o(()=>[(m(!0),c(S,null,v(l.tableData,a=>(m(),V(r,{key:a.entityName,label:a.tableName,value:a.entityName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[e(n,{label:"业务名",prop:"busName"},{default:o(()=>[e(f,{modelValue:l.ruleForm.busName,"onUpdate:modelValue":t[5]||(t[5]=a=>l.ruleForm.busName=a),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[e(n,{label:"父级菜单",prop:"menuPid"},{default:o(()=>[e(q,{options:l.menuData,props:{checkStrictly:!0,emitPath:!1,value:"id",label:"title"},placeholder:"请选择上级菜单",clearable:"",class:"w100",modelValue:l.ruleForm.menuPid,"onUpdate:modelValue":t[6]||(t[6]=a=>l.ruleForm.menuPid=a)},{default:o(({node:a,data:x})=>[g("span",null,y(x.title),1),a.isLeaf?K("",!0):(m(),c("span",X," ("+y(x.children.length)+") ",1))]),_:1},8,["options","modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[e(n,{label:"命名空间",prop:"nameSpace"},{default:o(()=>[e(f,{modelValue:l.ruleForm.nameSpace,"onUpdate:modelValue":t[7]||(t[7]=a=>l.ruleForm.nameSpace=a),clearable:"",placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[e(n,{label:"作者姓名",prop:"authorName"},{default:o(()=>[e(f,{modelValue:l.ruleForm.authorName,"onUpdate:modelValue":t[8]||(t[8]=a=>l.ruleForm.authorName=a),clearable:"",placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[e(n,{label:"生成方式",prop:"generateType"},{default:o(()=>[e(b,{modelValue:l.ruleForm.generateType,"onUpdate:modelValue":t[9]||(t[9]=a=>l.ruleForm.generateType=a),filterable:"",class:"w100"},{default:o(()=>[(m(!0),c(S,null,v(l.codeGenTypeList,a=>(m(),V(r,{key:a.value,label:a.value,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{ae as _};
