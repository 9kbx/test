import{K as S,r as P,a1 as j,k as Q,a0 as L,ak as i,au as k,o as d,a as O,Y as e,S as t,ac as x,T as N,R as p,W as r}from"./vue.e20a9695.js";import{e as g,f as w,z as T,E as z}from"./index.09fc6580.js";import{_ as W}from"./editCodeGenDialog.vue_vue_type_script_setup_true_name_sysEditCodeGen_lang.8901b7be.js";import{_ as Y}from"./genConfigDialog.vue_vue_type_script_setup_true_name_sysCodeGenConfig_lang.bcb63112.js";import{d as H}from"./download.b0f01c01.js";import{S as h}from"./sys-code-gen-api.8bf07fe8.js";import{_ as J}from"./_plugin-vue_export-helper.c27b6911.js";import"./monacoEditor.48edecf2.js";import"./sys-dict-data-api.f878fc34.js";import"./fkDialog.vue_vue_type_script_setup_true_name_sysCodeGenFk_lang.d6d1880e.js";import"./treeDialog.vue_vue_type_script_setup_true_name_sysCodeGenTree_lang.b38c5dcb.js";import"./sys-dict-type-api.a2f5abd5.js";const X={class:"sys-codeGen-container"},Z=S({name:"sysCodeGen"}),ee=S({...Z,setup(ae){const y=P(),v=P(),a=j({loading:!1,loading1:!1,dbData:[],configId:"",tableData:[],tableName:"",queryParams:{name:void 0,code:void 0,tableName:void 0,busName:void 0},tableParams:{page:1,pageSize:10,total:0},editMenuTitle:""});Q(async()=>{s(),g.on("submitRefresh",()=>{s()}),g.on("submitRefreshFk",()=>{a.tableData})}),L(()=>{g.off("submitRefresh",()=>{}),g.off("submitRefreshFk",()=>{})});const D=n=>{var o;(o=v.value)==null||o.openDialog(n)},R=()=>{a.queryParams.busName=void 0,a.queryParams.tableName=void 0,s()},s=async()=>{var f,m;a.loading=!0;let n=Object.assign(a.queryParams,a.tableParams),o=await w(h).apiSysCodeGenPagePost(n);a.tableData=((f=o.data.result)==null?void 0:f.items)??[],a.tableParams.total=(m=o.data.result)==null?void 0:m.total,a.loading=!1},q=n=>{a.tableParams.pageSize=n,s()},B=n=>{a.tableParams.page=n,s()},E=()=>{var n;a.editMenuTitle="增加",(n=y.value)==null||n.openDialog({nameSpace:"Admin.NET.Application",authorName:"Admin.NET",generateType:"200"})},G=n=>{var o;a.editMenuTitle="编辑",(o=y.value)==null||o.openDialog(n)},M=n=>{T.confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await w(h).apiSysCodeGenDeletePost([{id:n.id}]),s(),z.success("操作成功")}).catch(()=>{})},V=n=>{T.confirm("确定要生成吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{var o=await w(h).apiSysCodeGenRunLocalPost(n);o.data.result!=null&&o.data.result.url!=null&&H({url:o.data.result.url}),s(),z.success("操作成功")}).catch(()=>{})};return(n,o)=>{const f=i("el-input"),m=i("el-form-item"),c=i("el-button"),A=i("el-button-group"),K=i("el-form"),C=i("el-card"),u=i("el-table-column"),_=i("el-tag"),U=i("el-table"),$=i("el-pagination"),I=k("auth"),F=k("loading");return d(),O("div",X,[e(C,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:t(()=>[e(K,{model:a.queryParams,ref:"queryForm",inline:!0},{default:t(()=>[e(m,{label:"业务名",prop:"busName"},{default:t(()=>[e(f,{placeholder:"业务名",clearable:"",onKeyup:x(s,["enter"]),modelValue:a.queryParams.busName,"onUpdate:modelValue":o[0]||(o[0]=l=>a.queryParams.busName=l)},null,8,["onKeyup","modelValue"])]),_:1}),e(m,{label:"数据库表名",prop:"tableName"},{default:t(()=>[e(f,{placeholder:"数据库表名",clearable:"",onKeyup:x(s,["enter"]),modelValue:a.queryParams.tableName,"onUpdate:modelValue":o[1]||(o[1]=l=>a.queryParams.tableName=l)},null,8,["onKeyup","modelValue"])]),_:1}),e(m,null,{default:t(()=>[e(A,null,{default:t(()=>[N((d(),p(c,{type:"primary",icon:"ele-Search",onClick:s},{default:t(()=>[r(" 查询 ")]),_:1})),[[I,"sysMenu:list"]]),e(c,{icon:"ele-Refresh",onClick:R},{default:t(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1}),e(m,null,{default:t(()=>[e(c,{type:"primary",icon:"ele-Plus",onClick:E},{default:t(()=>[r(" 增加 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(C,{shadow:"hover",style:{"margin-top":"8px"}},{default:t(()=>[N((d(),p(U,{data:a.tableData,style:{width:"100%"},border:""},{default:t(()=>[e(u,{type:"index",label:"序号",width:"55",align:"center"}),e(u,{prop:"configId",label:"库定位器","show-overflow-tooltip":""}),e(u,{prop:"tableName",label:"表名称","show-overflow-tooltip":""}),e(u,{prop:"busName",label:"业务名","show-overflow-tooltip":""}),e(u,{prop:"nameSpace",label:"命名空间","show-overflow-tooltip":""}),e(u,{prop:"authorName",label:"作者姓名","show-overflow-tooltip":""}),e(u,{prop:"generateType",label:"生成方式","show-overflow-tooltip":""},{default:t(l=>[l.row.generateType==100?(d(),p(_,{key:0},{default:t(()=>[r(" 下载压缩包 ")]),_:1})):l.row.generateType==111?(d(),p(_,{key:1},{default:t(()=>[r(" 下载压缩包(前端) ")]),_:1})):l.row.generateType==121?(d(),p(_,{key:2},{default:t(()=>[r(" 下载压缩包(后端) ")]),_:1})):l.row.generateType==211?(d(),p(_,{key:3},{default:t(()=>[r(" 生成到本项目(前端) ")]),_:1})):l.row.generateType==221?(d(),p(_,{key:4},{default:t(()=>[r(" 生成到本项目(后端) ")]),_:1})):(d(),p(_,{key:5,type:"danger"},{default:t(()=>[r(" 生成到本项目 ")]),_:1}))]),_:1}),e(u,{label:"操作",width:"200",fixed:"right",align:"center","show-overflow-tooltip":""},{default:t(l=>[e(c,{size:"small",text:"",type:"primary",onClick:b=>V(l.row)},{default:t(()=>[r("开始生成")]),_:2},1032,["onClick"]),e(c,{size:"small",text:"",type:"primary",onClick:b=>D(l.row)},{default:t(()=>[r("配置")]),_:2},1032,["onClick"]),e(c,{size:"small",text:"",type:"primary",onClick:b=>G(l.row)},{default:t(()=>[r("编辑")]),_:2},1032,["onClick"]),e(c,{size:"small",text:"",type:"primary",onClick:b=>M(l.row)},{default:t(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[F,a.loading]]),e($,{currentPage:a.tableParams.page,"onUpdate:currentPage":o[2]||(o[2]=l=>a.tableParams.page=l),"page-size":a.tableParams.pageSize,"onUpdate:pageSize":o[3]||(o[3]=l=>a.tableParams.pageSize=l),total:a.tableParams.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:q,onCurrentChange:B,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])]),_:1}),e(W,{title:a.editMenuTitle,ref_key:"EditCodeGenRef",ref:y},null,8,["title"]),e(Y,{ref_key:"CodeConfigRef",ref:v},null,512)])}}});const _e=J(ee,[["__scopeId","data-v-aa58e4d9"]]);export{_e as default};
